// AfterEffects Input/Output Utility v3.x  Programed by kanbara.
//
//  ■v3.0
//  (13-04-20 13:00) v3.0.0.3
//　　　・設定ファイル読み込みのエラー処理が足りなかった部分を修正
//　　　　→Settingsの読み込み時にエラー処理追加。
//
//  (13-04-16 20:30) v3.0.0.2
//　　　・twitterにて、（セル入力が常に追加編集なので）deleteキー押すのに慣れなくて..というようなツイートが..
//　　　　→v2同様、初回編集ステートを追加してみた。
//　　　　　状態移行忘れ箇所が出るだろうから、他の機能を使った後のセル入力動作が怪しい部分があるかもしれない。
//
//  (11-09-26 10:00) v3.0.0.1
//      ・バグ出し、挙動の変化している部分の調査（個々の機能を一通り使ってみる）
//      　・セル挿入/削除が動かなくなっている
//      　　→初期化実装の修正でエンバグしていた。領域の再確保を忘れていたので追加。
//	　・AEからペースト時に開始位置が１つ下にずれている
//      　　→違っていたのは "AEへコピー"の方だった。"AEへコピー"のフレーム計算を 0から数える計算に修正。
//	　・行削除の初期キーバインドが違う（現状:Ctrl+BS 以前:Shift+Del）
//      　　→前の実装に合わせた。
//	　・内部変数から初回入力フラグが消えたので、BackSpace時の削除動作が、常に１桁削除になっている
//	　　※他にもあるかもしれない
//      　　→BackSpaceで巻き戻し削除時はセル内容の消去処理に実装を修正。
//          　新規入力〜編集状態に入った場合ではない時は１桁削除のまま..
//	　・入力位置が画面2/3になると画面送りする動作がない
//      　　→実装を追加(Enter, ↓, ピリオド, +, -, K)
//      　　→キーフレーム頭出しの画面送り動作が特別処理だったのも普通に送るように修正
//      　・HOMEキー押し下げ時に選択領域の内部変数が初期化されていなかったのを修正
//	　・"+", "-"押しでカラセル番号に到達した場合に達した場合の実装がない
//      　　→同じ動作をするように実装していたが、繰り返しカラセル入力されるのもおかしいので、反応しないように変更。
//	　・AEからペーストでFPS設定が変わる場合に、メニューのチェック内容が追従していない
//      　　→変更する実装を追加
//	　・複数セルに跨った動作の実装を忘れている
//	　・複数セル同時入力ができない
//      　　　→対応済：キー頭出し, 範囲削除(Delete, BS), 数値入力, カラセル入力
//      　　　→未対応：自動入力(+,-)
//	　・セル枚数指定実行時のアラート表示実装がない
//      　　→そもそも上限値を設定しないので必要がなかった（64bit化もあったので、今回特に縛りを設けていない）
//	　・セル名称編集実装がない
//      　　→実装した
//      　・セル名称が毎回初期化されている（挿入/削除でも初期化される）
//      　　→挿入/削除時の動作を修正（挿入セルは空欄。他は処理前のものを採用）
//      　　→セル枚数入力時の動作も別途修正（起動時は全セルに名称を付け、以降追加時は空欄にする）
//	　・入力補助実装に対応するショートカットキーの設定項目がない
//      　　→実装した
//
//  (11-09-25 17:00) v3.0.0.0
//      →ほぼV2.1.0.3相当の実装を完了。
//      　バグや挙動の変わった点の洗い出し開始。
